---
description: na
keywords: na
title: Rights Management sharing application administrator guide
search: na
ms.date: na
ms.service: rights-management
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: d9992e30-f3d1-48d5-aedc-4e721f7d7c25
---
# Руководство администратора по приложению управления доступом Rights Management
Используйте следующие сведения, если вы отвечаете за приложение для управления доступом Microsoft Rights Management в сети предприятия или если требуются более подробные технические сведения, чем в статье [Руководство пользователя по приложению управления доступом Rights Management](../Topic/Rights_Management_sharing_application_user_guide.md) или статье [Часто задаваемые вопросы о приложении для управления доступом Microsoft Rights Management для Windows](http://go.microsoft.com/fwlink/?LinkId=303971).

-   [Автоматическое развертывание приложения для управления доступом Microsoft Rights Management](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_ScriptedInstall)

    -   [Проверка успешного завершения установки](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_verifyscripted)

    -   [Команды удаления](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_uninstallscripted)

    -   [Отключение автоматического обновления](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_SuppressAutomaticUpdates)

    -   [Только Azure RMS: настройка отслеживания документов](#BKMK_DocumentTracking)

    -   [Только AD RMS поддержка нескольких доменов электронной почты в организации](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_FederatedDomains)

-   [Технический обзор приложения для управления доступом Microsoft Rights Management](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_AdminOverview)

    -   [Уровни защиты — собственный и универсальный](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_LevelsofProtection)

    -   [Поддерживаемые типы файлов и расширения имен файлов](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_SupportFileTypes)

    -   [Изменение уровня защиты файлов по умолчанию](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_ChangeDefaultProtection)

> [!TIP]
> Если вы не знакомы с приложением для управления доступом RMS или ищете дополнительные сведения, см. статью [Защита всех типов файлов с помощью RMS при использовании приложения для управления доступом RMS](https://curah.microsoft.com/191031/how-rms-protects-all-file-types-by-using-the-rms-sharing-app).

Приложение для управления доступом RMS наилучшим образом подходит для работы с Azure RMS, так как эта конфигурация развертывания поддерживает отправку защищенных вложений пользователям в другой организации и предоставляет такие возможности, как уведомления по электронной почте и отслеживание документов с отзывом.  Тем не менее с некоторыми ограничениями она также работает с локальной версией, службой AD RMS. Полное сравнение функций, поддерживаемых Azure RMS и AD RMS, см. в статье [Сравнение Azure Rights Management и AD RMS](https://technet.microsoft.com/library/jj739831.aspx). Если вы используете AD RMS и планируете перейти на Azure RMS, см. статью [Переход с AD RMS на Azure Rights Management](https://technet.microsoft.com/library/dn858447.aspx).

## <a name="BKMK_ScriptedInstall"></a>Автоматическое развертывание приложения для управления доступом Microsoft Rights Management
Версия приложения для управления доступом RMS для Windows поддерживает установку с помощью скриптов, что делает ее подходящей для развертывания в среде организаций.

Единственные предварительные условия для установки: компьютеры должны работать под управлением версии не ниже Windows 7 с пакетом обновления 1 (SP1) и должна быть установлена платформа Microsoft Framework версии не ниже 4.0. Если необходимо установить Microsoft .NET Framework 4.0, вы можете [скачать ее из Центра загрузки Майкрософт](http://www.microsoft.com/download/details.aspx?id=17718).

#### Скачивание приложения для управления доступом RMS для автоматического развертывания

1.  Перейдите на страницу [Приложение для управления доступом Microsoft Rights Management для Windows](http://www.microsoft.com/download/details.aspx?id=40857) в Центре загрузки Майкрософт и нажмите кнопку **Скачать**.

2.  Выберите и скачайте необходимые файлы. Существует два пакета установки клиента: один для 64-разрядных систем Windows (Microsoft Rights Management sharing application x64.zip), а второй — для 32-разрядных систем Windows (Microsoft Rights Management sharing application x86.zip).

3.  Извлеките файлы из сжатых установочных пакетов, например двойным щелчком. Затем скопируйте извлеченные файлы в сетевую папку, к которой имеют доступ клиентские компьютеры.

Установочные пакеты для приложения для управления доступом RMS поддерживают различные сценарии развертывания и включают следующие компоненты.

|Описание|Сценарий развертывания|
|------------|--------------------------|
|Помощник по входу в Microsoft Online|Необходимы следующие компоненты:<br /><br />-   Office 2010 и Azure RMS<br />-   Office 2013 и Azure RMS, если не установлено [обновление для Office 2013 от 9 июня 2015 г.](https://support.microsoft.com/kb/3054853) (3054853)|
|Исправление для Office (2596501)|Необходимы следующие компоненты:<br /><br />-   Office 2010 и Azure RMS<br />-   Office 2010 и Active Directory RMS|
|Исправление, предназначенное для обеспечения работы AD RMS Client 1.0 с Azure RMS (2843630)|Необходимы следующие компоненты:<br /><br />-   Office 2010 и Azure RMS<br />-   Office 2010 и Active Directory RMS|
|Клиент AD RMS и приложение для управления доступом RMS|Требуется для следующих компонентов:<br /><br />-   Office 2016 или Office 2013 и Azure RMS или Active Directory RMS<br />-   Office 2010 и Azure RMS<br />-   Office 2010 и Active Directory RMS<br />-   Только приложение управления доступом RMS и надстройка Office|
|Надстройка Office для ленты|Требуется для следующих компонентов:<br /><br />-   Office 2016 или Office 2013 и Azure RMS или Active Directory RMS<br />-   Office 2010 и Azure RMS<br />-   Office 2010 и Active Directory RMS<br />-   Только приложение управления доступом RMS и надстройка Office|
|Средство подготовки Azure Active Directory Rights Management|Необходимы следующие компоненты:<br /><br />-   Office 2010 и Azure RMS|
Следующие процедуры используются для определения команд, необходимых для развертывания приложения для управления доступом RMS в рамках этих сценариев развертывания:

-   **Office 2016 или Office 2013 и Azure RMS или Active Directory RMS**

    Пользователи работают в Office 2016 или Office 2013, ваша организация использует Azure RMS или Active Directory RMS и пользователи работают совместно с другими организациями, которые используют Azure RMS или Active Directory RMS.

-   **Office 2010 и Azure RMS**

    Пользователи работают с Office 2010, ваша организация использует Azure RMS и пользователи работают совместно с другими организациями, которые используют Azure RMS или Active Directory RMS.

-   **Office 2010 и Active Directory RMS**

    Пользователи работают с Office 2010, ваша организация использует AD RMS и пользователи работают совместно с другими организациями, которые используют Azure RMS.

-   **Только приложение для управления доступом RMS и надстройка Office**

    Пользователи работают с Office 2016, Office 2013 или Office 2010, ваша организация использует AD RMS и пользователям не нужно работать совместно с другими организациями, которые используют Azure RMS. Эта установка позволяет устанавливать только приложение для управления доступом и надстройку Office.

> [!NOTE]
> В этих сценариях, если организация использует AD RMS, пользователи смогут получать защищенное содержимое из других организаций, которые используют Azure RMS, но не смогут отправлять защищенное содержимое пользователям в организации, использующей Azure RMS. Но если в вашей организации используется Azure RMS, ваши пользователи смогут отправлять и получать защищенное содержимое из других организаций.

Чтобы завершить установку для каждой процедуры, необходимо перезагрузить компьютер. Автоматическую перезагрузку можно выполнить с помощью команды shutdown /i.

#### Развертывание приложения для управления доступом RMS для Office 2016 или Office 2013 и Azure RMS или Active Directory RMS

-   На каждом компьютере, на котором требуется установить приложение для управления доступом RMS и связанные компоненты, выполните следующую команду с повышенными привилегиями:

    ```
    setup.exe /s
    ```

Для проверки успешности ее выполнения см. раздел [Проверка успешного завершения установки](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_verifyscripted) в этой статье.

#### Развертывание приложения для управления доступом RMS для Office 2010 и Azure RMS

1.  Необходимо быть глобальным администратором Office 365 или клиента Azure Active Directory, чтобы получить URL-адрес службы сертификации организации, запустив средство подготовки Azure Active Directory Rights Management. Это средство необходимо запустить только один раз на каждом компьютере. URL-адрес службы сертификации будет использоваться при установке приложения для управления доступом RMS на каждом компьютере.

    1.  Войдите на компьютер с помощью учетной записи локального администратора.

    2.  На этом компьютере [скачайте и установите помощник по входу в Microsoft Online](http://www.microsoft.com/download/details.aspx?id=28177).

    3.  Выполните следующую команду, чтобы получить отображаемый на экране URL-адрес службы сертификации, который можно скопировать и сохранить для следующего шага.

        -   Для Windows 8.1 и Windows 8 (64-разрядной версии):

            ```
            x64\aadrmprep.exe /findCertificationUrl /logfile "<log file path and name>"
            ```

        -   Для Windows 8.1 и Windows 8 (32-разрядной версии):

            ```
            X86\aadrmprep.exe /findCertificationUrl /logfile "<log file path and name>"
            ```

        -   Для Windows 7 (64-разрядной версии):

            ```
            x64\win7\aadrmprep.exe /findCertificationUrl /logfile "<log file path and name>"
            ```

        > [!NOTE]
        > Эта команда может запросить ввод учетных данных для Azure. Если компьютер не присоединен к домену, вам будет предложено присоединить его. Если компьютер входит в домен, это средство может смочь использовать кэшированные учетные данные.

2.  На каждом компьютере, на котором требуется установить приложение для управления доступом RMS, выполните следующую команду с повышенными привилегиями:

    ```
    setup.exe /s /configureO2010Admin /certificationUrl <certification_url>
    ```

3.  На каждом компьютере, на котором требуется установить приложение управления доступом RMS, пользователи должны выполнить следующую команду (повышенные привилегии не требуются): Существуют различные способы достижения этого результата: можно попросить пользователей ее выполнить (например, с помощью ссылки в сообщении электронной почты или ссылки на портал службы поддержки), можно добавить команду в скрипт входа.

    ```
    bin\RMSSetup.exe /configureO2010Only
    ```

Для проверки успешности выполнения см. раздел[Проверка успешного завершения установки](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_verifyscripted)в этой статье.

#### Развертывание приложения для управления доступом RMS для Office 2010 и Active Directory RMS

1.  На каждом компьютере, на котором требуется установить приложение управления доступом RMS, выполните следующую команду с повышенными привилегиями:

    ```
    setup.exe /s /configureO2010Admin
    ```

2.  На каждом компьютере, на котором требуется установить приложение управления доступом RMS, пользователи должны выполнить следующую команду (повышенные привилегии не требуются): Существуют различные способы достижения этого результата: можно попросить пользователей ее выполнить (например, с помощью ссылки в сообщении электронной почты или ссылки на портал службы поддержки), можно добавить команду в скрипт входа.

    -   Для Windows 10 и Windows 8.1 и Windows 8 (64-разрядная версия):

        ```
        x64\aadrmprep.exe /configureO2010
        ```

    -   Для Windows 10 и Windows 8.1 и Windows 8 (32-разрядная версия):

        ```
        X86\aadrmprep.exe /configureO2010
        ```

    -   Для Windows 7 (64-разрядной версии):

        ```
        x64\win7\aadrmpep.exe /configureO2010
        ```

Для проверки успешности выполнения см. раздел[Проверка успешного завершения установки](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_verifyscripted)в этой статье.

#### Установка только приложения для управления доступом RMS и надстройки Office

1.  Установите клиент AD RMS и приложение для управления доступом RMS с помощью следующей команды:

    -   Для 64-разрядной версии Windows:

        ```
        x64\setup_ipviewer.exe /norestart /quiet /msicl "MSIRESTARTMANAGERCONTROL=Disable" /log "<log file path and name>"
        ```

    -   Для 32-разрядной версии Windows:

        ```
        X86\setup_ipviewer.exe /norestart /quiet /msicl "MSIRESTARTMANAGERCONTROL=Disable" /log "<log file path and name>"
        ```

    Например: `\\server5\apps\rms\x64\setup_ipviewer.exe /norestart /quiet /msicl "MSIRESTARTMANAGERCONTROL=Disable" /log "C:\Log files\ipviewerinstall.log"`

2.  Установите надстройку Office с помощью следующих команд:

    -   Для 64-разрядной версии Office:

        ```
        msiexec.exe /norestart /quiet MSIRESTARTMANAGERCONTROL=Disable /i "x64\Setup64.msi" /L*v "<log file path and name>"
        ```

    -   Для 32-разрядной версии Office:

        ```
        msiexec.exe /norestart /quiet MSIRESTARTMANAGERCONTROL=Disable /i "x86\Setup.msi" /L*v "<log file path and name>"
        ```

    Например: `\\server5\apps\rms\msiexec.exe /norestart /quiet MSIRESTARTMANAGERCONTROL=Disable /i "x64\Setup64.msi" /L*v "C:\Log files\rmsofficeinstall.log"`

Для проверки успешности выполнения см. раздел[Проверка успешного завершения установки](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_verifyscripted)в этой статье.

### <a name="BKMK_verifyscripted"></a>Проверка успешного завершения установки
Для проверки успешности установки можно использовать файлы журнала установки.

##### Проверка успешности установки приложения для управления доступом RMS для Office 2016 или Office 2013 и Azure RMS или Active Directory RMS

-   Для проверки успешности выполнения команды Setup.exe на каждом компьютере найдите файл журнала установки **RMInstaller.log** в папке *%temp%\RMS_installer_&lt;guid&gt;*, а затем определите код выхода.

    Успешная установка имеет код выхода 0, а любые другие значения указывают на сбой установки.

    Пример имени файла журнала: **C:\temp\RMS_Installer_9352fc91-1982-43bf-958a-2ef1fe9c2ed0\RMInstaller.log**

##### Проверка успешности установки приложения для управления доступом RMS для Office 2010 и Azure RMS

1.  Для проверки успешности выполнения команды Setup.exe на каждом компьютере найдите файл журнала установки**RMInstaller.log**в папке *%temp%\RMS_installer_ &lt; guid &gt;*, а затем определите код выхода.

    Успешная установка имеет код выхода 0, а любые другие значения указывают на сбой установки.

    Образец имени файла журнала: **C:\temp\RMS_Installer_9352fc91-1982-43bf-958a-2ef1fe9c2ed0**

2.  Для проверки успешности выполнения команды RMSSetup.exe пользователь должен иметь следующие файлы, созданные в папке *%localappdata%\microsoft\drm*:

    -   CERT-Machine-2048.drm

    -   CERT-Machine.drm

    -   CLC-&#42;.drm

    -   GIC-&#42;.drm

    Пример файла CLC-&#42;.drm:

    **CLC-alice@isvtenant999.onmicrosoft.com-{1b9cfccf;k5b11;k4a10;kac15;k29b2b6980f4c}.drm**

##### Проверка успешности установки приложения для управления доступом RMS для Office 2010 и Active Directory RMS

1.  Для проверки успешности выполнения команды Setup.exe на каждом компьютере найдите файл журнала установки в папке *%temp%\RMS_installer_&lt;guid&gt;*, а затем определите код выхода.

    Успешная установка имеет код выхода 0, а любые другие значения указывают на сбой установки.

    Образец имени файла журнала: **C:\temp\RMS_Installer_9352fc91-1982-43bf-958a-2ef1fe9c2ed0**

2.  Для проверки успешности выполнения команды aadrmprep.exe на каждом компьютере найдите следующий текст в файле журнала установки: **aadrmprep.exe exited with status SUCCESS** (aadrmprep.exe завершился с состоянием SUCCESS).

    > [!NOTE]
    > В некоторых случаях можно запустить установку дважды. Первая попытка завершается ошибкой, а вторая проходит успешно.

    Если необходимо вручную проверить изменения в реестре, которые вносит это средство, то они следующие:

    -   [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDRM\Federation]

        "FederationHomeRealm"="urn:HostedRmsOnlineService:Certification"

    -   [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSDRM\Federation]

        "FederationHomeRealm"="urn:HostedRmsOnlineService:Certification"

    -   [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSDRM\ServiceLocation\Activation]

        @="&lt;URL-адрес_сертификата&gt;"

    -   [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\14.0\Common\DRM]

        DefaultUser="&lt;пользователь_по_умолчанию&gt;"

##### Проверка успешности установки только приложения для управления доступом RMS и надстройки Office

1.  Для проверки успешности выполнения команды Setup_ipviewer.exe найдите следующий текст в файле журнала установки: **Установка завершена с состоянием: 0**

    Пример строки при успешной установке:

    **MSI (s) (F0:B8) [14:19:57:854]: Продукт: Клиент служб Active Directory Rights Management версии 2.1 — установка успешно завершена.**

    **MSI (s) (F0:B8) [14:19:57:854]: Установщик Windows установил продукт. Название продукта: Клиент служб Active Directory Rights Management 2.1. Версия продукта: 1.0.1179.1. Язык: 1033. Изготовитель: Корпорация Майкрософт (Microsoft Corporation) Состояние успеха или ошибки установки: 0.**

2.  Для проверки успешности установки надстройки Office на каждом компьютере выполните поиск следующих текстовых строк в файле журнала установки: **Состояние успеха или ошибки установки: 0**

    Пример строки при успешной установке:

    **MSI (s) (9C:88) [18:49:04:007]: Продукт: Надстройки Office Microsoft RMS — установка успешно завершена.**

    **MSI (s) (9C:88) [18:49:04:007]: Установщик Windows установил продукт. Название продукта: Надстройки Microsoft RMS Office. Версия продукта: 1.0.7. Язык: 1033. Изготовитель: Корпорация Майкрософт (Microsoft Corporation). Состояние успеха или ошибки установки: 0.**

### <a name="BKMK_uninstallscripted"></a>Команды удаления
Не все команды для установки, необходимые для этих развертываний, поддерживают команду удаления. Можно удалить клиент AD RMS и приложение для управления доступом, а также надстройку Office. Для удаления этих элементов используются следующие команды.

##### Удаление клиента AD RMS и приложения для управления доступом RMS

-   Выполните следующие команды:

    -   Для 64-разрядной версии Windows:

        ```
        x64\setup_ipviewer.exe /uninstall /quiet
        ```

    -   Для 32-разрядной версии Windows:

        ```
        x86\setup_ipviewer.exe /uninstall /quiet
        ```

##### Удаление надстройки Office

-   Выполните следующие команды:

    -   Для 64-разрядной версии Office:

        ```
        msiexec /x \x64\Setup[64].msi /quiet
        ```

    -   Для 32-разрядной версии Office:

        ```
        msiexec /x \x86\Setup.msi /quiet
        ```

### <a name="BKMK_SuppressAutomaticUpdates"></a>Отключение автоматического обновления
По умолчанию пользователи получают уведомление о наличии более поздней версии приложения для управления доступом RMS и приглашение скачать ее. Это уведомление можно отключить, изменив следующий параметр реестра:

1.  Перейдите к разделу **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC** и создайте новый раздел с именем **RmsSharingApp**, если он отсутствует.

2.  Выберите **RmsSharingApp**, создайте новое значение DWORD для **AllowUpdatePrompt** и задайте для него **0**.

Поскольку приложение для управления доступом RMS не поддерживается службами WSUS, можно использовать следующий способ для тестирования всех новых версий этого приложения перед его развертыванием для всех пользователей:

1.  На всех компьютерах пользователей выполните скрипт для отключения автоматического обновления. Не запускайте этот скрипт на компьютерах, используемых администраторами для проверки новых версий.

2.  Если доступна новая версия, администраторы скачивают и тестируют ее.

3.  После завершения тестирования и устранения всех проблем разверните последнюю версию для всех пользователей с помощью инструкций по автоматическому развертыванию, приведенных в этом руководстве.

### <a name="BKMK_DocumentTracking"></a>Только Azure RMS: настройка отслеживания документов
При наличии [подписки, которая поддерживает отслеживание документов](https://technet.microsoft.com/en-us/dn858608), сайт отслеживания документов включен по умолчанию для всех пользователей в организации.  При отслеживании документов отображаются такие сведения, как адреса электронной почты пользователей, которые пытались получить доступ к защищенным документам, время этих попыток и их местонахождение. Если отображение этой информации запрещено в вашей организации согласно требованиями конфиденциальности, можно отключить доступ к сайту отслеживания документов с помощью командлета [Disable-AadrmDocumentTrackingFeature](http://go.microsoft.com/fwlink/?LinkId=623032). Доступ к сайту можно возобновить в любое время с помощью командлета [Enable-AadrmDocumentTrackingFeature](http://go.microsoft.com/fwlink/?LinkId=623037). А с помощью командлета [Get-AadrmDocumentTrackingFeature](http://go.microsoft.com/fwlink/?LinkId=623037) можно проверить состояние доступа — включено или отключено.

 Чтобы выполнить эти командлеты, необходимо иметь по меньшей мере версию **2.3.0.0** модуля Azure RMS для Windows PowerShell.  Инструкции по установке см. в статье [Установка Windows PowerShell для службы Azure Rights Management](https://technet.microsoft.com/library/jj585012.aspx).

> [!TIP]
> Если модуль был скачан и установлен ранее, проверьте номер версии, выполнив следующую команду: `(Get-Module aadrm –ListAvailable).Version`

Следующие URL-адреса используются для отслеживания документов и должны быть разрешены (например, добавьте их в число надежных сайтов, если используется браузер Internet Explorer с повышенным уровнем безопасности):

-   https://&#42;.azurerms.com

-   https://ecn.dev.virtualearth.net

    > [!NOTE]
    > Это URL-адрес для Карт Bing.

-   https://&#42;.microsoftonline.com

-   https://&#42;.microsoftonline-p.com

### <a name="BKMK_FederatedDomains"></a>Только AD RMS поддержка нескольких доменов электронной почты в организации
Если используется AD RMS и пользователи в организации имеют несколько доменов электронной почты (возможно в результате слияния или приобретения), необходимо сделать следующие изменения в реестре:

1.  Перейдите к**HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC**и создайте новый раздел с именем**RmsSharingApp**, если он отсутствует.

2.  Выберите **RmsSharingApp**, создайте новый многостроковый параметр с именем **FederatedDomains**, а затем добавьте домены и все поддомены, используемые вашей организацией. Подстановочные знаки не поддерживаются.

    Например: Компания Coho Vineyard &amp; Winery имеет стандартный домен электронной почты **cohovineyardandwinery.com**, но в результате слияния она также использует домены электронной почты **cohowinery.com**, **eastcoast.cohowinery.com** и **cohovineyard**. В качестве значения параметра **FederatedDomains** администратор вводит **cohowinery.com; eastcoast.cohowinery.com; cohovineyard**

Если не внести это изменение в реестр, пользователи не смогут использовать содержимое, защищенное другими пользователями в организации. Это изменение реестра не требуется при использовании Azure RMS.

## <a name="BKMK_AdminOverview"></a>Технический обзор приложения для управления доступом Microsoft Rights Management
Приложение для управления доступом Microsoft Rights Management является дополнительным скачиваемым приложением для Microsoft Windows и других платформ и предоставляет следующие возможности:

-   защита отдельного файла или нескольких файлов, а также всех файлов в выбранной папке;

-   полная поддержка защиты файла любого типа и встроенные средства просмотра для часто используемых типов текстовых файлов и файлов изображений;

-   универсальная защита для файлов, которые не поддерживают защиту RMS;

-   полное взаимодействие с файлами, защищенными с помощью управления правами на доступ к данным Office (IRM);

-   полное взаимодействие с PDF-файлами, защищенными с помощью SharePoint, FCI и поддерживаемых средств создания PDF.

Приложение для управления доступом Microsoft Rights Management использует новую [среду выполнения клиента AD RMS 2.1](http://www.microsoft.com/download/details.aspx?id=38396). Благодаря функциональным возможностям AD RMS 2.1 приложение для управления доступом Microsoft Rights Management предоставляет конечным пользователям простой интерфейс для защиты данных и их использования.

Выпуск RMS от октября 2013 г. позволяет защищать документы непосредственно в Office 2010 и отправлять их другим пользователям в другой компании, которые затем смогут использовать их с помощью Azure RMS. Кроме того, в этом выпуске при применении AD RMS в режиме шифрования 2 можно использовать службу RMS для частных лиц и использовать содержимое, полученное от сотрудников другой компании, которая применяет Azure RMS. Дополнительные сведения о режиме шифрования 2 см. в статье [Режимы шифрования AD RMS](http://technet.microsoft.com/library/hh867439%28v=ws.10%29.aspx).

### <a name="BKMK_LevelsofProtection"></a>Уровни защиты — собственный и универсальный
Приложение для управления доступом Microsoft Rights Management поддерживает защиту на двух различных уровнях, как описано в следующей таблице.

|Тип защиты|Собственный|Универсальный шаблон|
|--------------|---------------|------------------------|
|Описание|Для текстовых файлов, изображений, файлов Microsoft Office (Word, Excel, PowerPoint), PDF-файлов и некоторых других типов файлов приложений, поддерживающих AD RMS, собственная защита обеспечивает высокий уровень защиты, включающий шифрование и применение прав доступа (разрешений).|Для всех других приложений и типов файлов универсальная защита обеспечивает уровень защиты, включающий инкапсуляцию файлов с помощью файлов типа PFILE и проверку подлинности для проверки прав пользователя на открытие файла.|
|Защита|Полное шифрование файлов и защита обеспечивается одним из следующих способов.<br /><br />-   Перед переходом к просмотру защищенного содержимого необходимо успешно пройти проверку подлинности (для тех лиц, кто получил файл по электронной почте или получает доступ к нему через разрешения для файла или общей папки).<br />-   Кроме того, права на использование и политики, установленные владельцем содержимого при защите файлов, полностью применяются при просмотре содержимого в средстве просмотра интеллектуальной собственности (для защищенных текстовых и графических файлов) или связанном приложении (для всех других поддерживаемых типов файлов).|Защита файлов обеспечивается одним из следующих способов.<br /><br />-   Перед переходом к просмотру защищенного содержимого необходимо успешно пройти проверку подлинности (чтобы убедиться, что лицо имеет право открыть файл и ему к нему предоставлен доступ). В случае непрохождения авторизации файл не открывается.<br />-   Права на использование и политика, установленные владельцем содержимого, отображаются для информирования авторизованных пользователей о политике использования.<br />-   Для приложений, которые не поддерживают права на использование, ведется журнал аудита авторизованных пользователей, открытия и доступа к файлам.|
|По умолчанию для типов файлов|Это уровень защиты по умолчанию для следующих типов файлов:<br /><br />-   Текстовые и графические файлы.<br />-   Файлы Microsoft Office (Word, Excel, PowerPoint).<br />-   PDF.<br /><br />Дополнительные сведения см. в следующем разделе [Поддерживаемые типы файлов и расширения имен файлов](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_SupportFileTypes).|Этот уровень является уровнем защиты по умолчанию для всех остальных типов файлов (например, VSDX, RTF и т. д.), которые не поддерживаются полной защитой.|
Можно изменить уровень защиты по умолчанию, который применяется приложением для управления доступом RMS. Можно изменить уровень по умолчанию с собственного на универсальный, с универсального на собственный и даже отключить применение защиты приложением для управления доступом RMS. Для получения дополнительных сведений см. подраздел [Изменение уровня защиты файлов по умолчанию](../Topic/Rights_Management_sharing_application_administrator_guide.md#BKMK_ChangeDefaultProtection) в этом разделе.

### <a name="BKMK_SupportFileTypes"></a>Поддерживаемые типы файлов и расширения имен файлов
В следующей таблице перечислены типы файлов, изначально поддерживаемые приложением для управления доступом Microsoft Rights Management. Для файлов этих типов исходное расширение имени файла меняется, когда применяется собственная защита, и эти файлы становятся доступны только для чтения.

Кроме того, если приложение для управления доступом RMS защищает файл Word, Excel или PowerPoint с использованием собственной защиты, защищаемый пользователем для отправки другому лицу, это действие автоматически создает второй файл, который является копией исходного с тем же именем, но с расширением **.ppdf**¹. Эта версия файла гарантирует, что получатели с установленным приложением для управления доступом RMS всегда смогут открыть файл, который защищен с применением собственной защиты.

Для файлов с универсальной защитой расширение имени исходного файла всегда меняется на ".pfile".

> [!WARNING]
> При наличии брандмауэров, веб-прокси или программных систем безопасности, которые проверяют и предпринимают действия по расширениям имен файлов, может потребоваться перенастроить их для поддержки этих новых расширений имен файлов.

|Расширение имени исходного файла|Расширение имени файла, защищенного RMS|
|------------------------------------|-------------------------------------------|
|.txt|.ptxt|
|.xml|.pxml|
|.jpg|.pjpg|
|.jpeg|.ppng|
|.pdf|.ppdf|
|.png|.ppng|
|.tiff|.ptiff|
|.bmp|.pbmp|
|.gif|.pgif|
|.giff|.pgiff|
|.jpe|.pjpe|
|.jfif|.pjfif|
|.jif|.pjif|
|.jt|.pjt|
¹ отображение PDF на основе Foxit. © Корпорация Foxit (Foxit Corporation), 2003–2014.

Ниже перечислены типы файлов, изначально поддерживаемые приложением для управления доступом Microsoft Rights Management в Microsoft Office 2016, Office 2013 и Office 2010. Для этих файлов расширение имени файла остается неизменным после защиты файла с помощью RMS.

|Типы файлов, поддерживаемые Office|Типы файлов, поддерживаемые Office|
|--------------------------------------|--------------------------------------|
|.doc<br /><br />.docm<br /><br />.docx<br /><br />.dot<br /><br />.dotm<br /><br />.dotx<br /><br />.potm<br /><br />.potx<br /><br />.pps<br /><br />.ppsm<br /><br />.ppsx<br /><br />.ppt<br /><br />.pptm|.pptx<br /><br />.thmx<br /><br />.xla<br /><br />.xlam<br /><br />.xls<br /><br />.xlsb<br /><br />.xlt<br /><br />.xlsm<br /><br />.xlsx<br /><br />.xltm<br /><br />.xltx<br /><br />.xps|

### <a name="BKMK_ChangeDefaultProtection"></a>Изменение уровня защиты файлов по умолчанию
Можно изменить уровень защиты файлов с помощью приложения для управления доступом RMS путем редактирования реестра. Например, к файлам, поддерживающим собственную защиту, можно принудительно применить универсальную защиту, которая обеспечивается приложением для управления доступом RMS.

Для этого существуют следующие причины:

-   чтобы гарантировать, что все пользователи могут открывать файл со своих мобильных устройств;

-   чтобы гарантировать, что все пользователи могут открыть файл, если у них нет приложения, поддерживающего собственную защиту;

-   для согласования с системами безопасности, которые предпринимают действия над файлами по расширению их имен и могут быть перенастроены на использование расширения имени файла ".pfile", но не могут быть перенастроены на использование нескольких расширений имен файлов для собственной защиты.

Аналогично можно заставить приложение для управления доступом RMS применять собственную защиту к файлам, к которым по умолчанию применялась бы универсальная защита. Это может быть целесообразным, если используется приложение, которое поддерживает API-интерфейсы RMS, например бизнес-приложение, написанное внутренними разработчиками, или приложение, приобретенное у независимого поставщика программного обеспечения (ISV).

Можно также сделать так, чтобы приложение для управления доступом RMS блокировало защиту файлов (не применяло собственную или универсальную защиту). Например, это может потребоваться при наличии автоматизированного приложения или службы, которые должны иметь возможность открыть конкретный файл для обработки его содержимого. При блокировке защиты для типа файлов пользователи не смогут использовать приложение для управления доступом RMS для защиты файлов данного типа. При попытке сделать это они увидят сообщение, информирующее, что администратор запретил защиту и им необходимо отменить свои действия по защите файла.

Чтобы настроить приложение для управления доступом RMS на применение универсальной защиты ко всем файлам, к которым по умолчанию применялась бы собственная защита, необходимо сделать следующие изменения в реестре:

1.  **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC\RMSSharingApp\FileProtection**: Создайте новый раздел с именем **&#42;**.

    Этот параметр указывает файлы с любым расширением имени.

2.  В добавленном разделе **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC\RMSSharingApp\FileProtection\&#42;** создайте новый строковый параметр (REG_SZ) с именем **Encryption** и значением **Pfile**.

    В результате этой настройки приложение для управления доступом RMS будет применять универсальную защиту.

Эти две настройки приведут к тому, что приложение для управления доступом RMS будет применять универсальную защиту ко всем файлам, имеющим расширение имени файла. Если вам необходимо именно это, дальнейшая настройка не требуется. Однако можно задать исключения для определенных типов файлов, чтобы к ним по-прежнему применялась собственная защита. Для этого необходимо внести три изменения в реестр для каждого типа файлов:

1.  **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC\RMSSharingApp\FileProtection**: Добавьте новый раздел с именем расширения файла (без точки в начале).

    Например, для файлов с расширением ".docx" создайте раздел с именем **DOCX**.

2.  В добавленном разделе типа файлов (например, **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC\RMSSharingApp\FileProtection\DOCX** создайте новый параметр DWORD с именем **AllowPFILEEncryption** и значением **0**.

3.  В добавленном разделе типа файлов (например, **HKEY_LOCAL_MACHINE\Software\Microsoft\MSIPC\RMSSharingApp\FileProtection\DOCX** создайте новый строковый параметр с именем **Encryption** и значением **Native**.

В результате этих настроек ко всем файлам будет применяться универсальная защита за исключением файлов с расширением ".docx", к которым будет применяться собственная защита приложением для управления доступом RMS.

Повторите эти три шага для других типов файлов, которые необходимо определить как исключения, поскольку они поддерживают собственную защиту и вы не хотите, чтобы к ним применялась универсальная защита приложением для управления доступом RMS.

Можно внести аналогичные изменения в реестр для других сценариев, изменив значение строкового параметра **Encryption**, который поддерживает следующие значения:

-   **Pfile**: Универсальная защита

-   **Native**: собственная защита

-   **Off**: блокировка защиты

## См. также
[Руководство пользователя по приложению управления доступом Rights Management](../Topic/Rights_Management_sharing_application_user_guide.md)

